{
    "##": "抖音",
    "version": "4.7.0",
    "description": "Douyin PC Client",
    "homepage": "https://www.douyin.com/",
    "license": "Freeware",
    "url": "https://lf3-cdn-tos.bytegoofy.com/obj/douyin-pc-client/7044145585217083655/releases/12159605/4.7.0/win32-mix/douyin-v4.7.0-win32-mix-default.exe#/dl.7z",
    "hash": "9b753a3d163bbf2fc535138e65e9950d22844718f2d6df8e31b744795c6cf2f5",
    "installer": {
        "script": [
            "Remove-Item \"$dir\\*\" -Exclude 'app.7z' -Force -Recurse",
            "Expand-7zipArchive \"$dir\\app.7z\" \"$dir\" -Removal",
            "Remove-Item \"$dir\\tray\\douyin_widget.exe\" -Force",
            "Remove-Item \"$dir\\installer_downloader.exe\" -Force",
            "Import-Module $(Join-Path $(Find-BucketDirectory -Root -Name PrivateBucket) scripts/DoradoUtils.psm1)",
            "Mount-ExternalRuntimeData -Source \"$persist_dir\\UserData\" -Target \"$env:APPDATA\\douyin\"",
            "Remove-Module -Name DoradoUtils"
        ]
    },
    "uninstaller": {
        "script": [
            "Import-Module $(Join-Path $(Find-BucketDirectory -Root -Name PrivateBucket) scripts/DoradoUtils.psm1)",
            "Dismount-ExternalRuntimeData -Target \"$env:APPDATA\\douyin\"",
            "Remove-Module -Name DoradoUtils"
        ]
    },
    "shortcuts": [
        [
            "douyin.exe",
            "抖音"
        ]
    ],
    "persist": "UserData",
    "checkver": {
        "script": [
            "$response = Invoke-RestMethod -Uri 'https://api.toutiaoapi.com/service/settings/v3/?aid=430651&device_id=2689510738&device_platform=pc&from_aid=6383&from_channel&from_version=0.0.0' -Method GET",
            "$version = $response.data.settings.douyin_pc_update.version",
            "$url = $response.data.settings.douyin_pc_update.url",
            "$md5 = $response.data.settings.douyin_pc_update.md5",
            "Write-Output \"$version|$url|$md5\""
        ],
        "regex": "^(?<version>[\\d.]+)\\|(?<url>https?://[\\S]+)\\|(?<md5>[a-fA-F0-9]+)$"
    },
    "autoupdate": {
        "url": "$matchUrl#/dl.7z"
    }
}
